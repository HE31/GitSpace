var cryption={};!function(t){function e(i,t,e){this.e=y(i),this.d=y(t),this.m=y(e),this.chunkSize=2*b(this.m),this.radix=16,this.barrett=new r(this.m)}function n(i,t){for(var e=new Array,n=t.length,r=0;n>r;)e[r]=t.charCodeAt(r),r++;for(;e.length%i.chunkSize!=0;)e[r++]=0;var s,o,g,a=e.length,u="";for(r=0;a>r;r+=i.chunkSize){for(g=new d,s=0,o=r;o<r+i.chunkSize;++s)g.digits[s]=e[o++],g.digits[s]+=e[o++]<<8;var c=i.barrett.powMod(g,i.e),l=16==i.radix?v(c):f(c,i.radix);u+=l+" "}return u.substring(0,u.length-1)}function r(i){this.modulus=u(i),this.k=b(this.modulus)+1;var t=new d;t.digits[2*this.k]=1,this.mu=V(t,this.modulus),this.bkplus1=new d,this.bkplus1.digits[this.k+1]=1,this.modulo=s,this.multiplyMod=o,this.powMod=g}function s(i){var t=P(i,this.k-1),e=M(t,this.mu),n=P(e,this.k+1),r=z(i,this.k+1),s=M(n,this.modulus),o=z(s,this.k+1),g=w(r,o);g.isNeg&&(g=m(g,this.bkplus1));for(var a=K(g,this.modulus)>=0;a;)g=w(g,this.modulus),a=K(g,this.modulus)>=0;return g}function o(i,t){var e=M(i,t);return this.modulo(e)}function g(i,t){var e=new d;e.digits[0]=1;for(var n=i,r=t;;){if(0!=(1&r.digits[0])&&(e=this.multiplyMod(e,n)),r=x(r,1),0==r.digits[0]&&0==b(r))break;n=this.multiplyMod(n,n)}return e}function a(i){T=i,q=new Array(T);for(var t=0;t<q.length;t++)q[t]=0;E=new d,L=new d,L.digits[0]=1}function d(i){"boolean"==typeof i&&1==i?this.digits=null:this.digits=q.slice(0),this.isNeg=!1}function u(i){var t=new d(!0);return t.digits=i.digits.slice(0),t.isNeg=i.isNeg,t}function c(i){var t=new d;t.isNeg=0>i,i=Math.abs(i);for(var e=0;i>0;)t.digits[e++]=i&B,i>>=G;return t}function l(i){for(var t="",e=i.length-1;e>-1;--e)t+=i.charAt(e);return t}function f(i,t){var e=new d;e.digits[0]=t;for(var n=S(i,e),r=D[n[1].digits[0]];1==K(n[0],E);)n=S(n[0],e),digit=n[1].digits[0],r+=D[n[1].digits[0]];return(i.isNeg?"-":"")+l(r)}function h(t){var e=15,n="";for(i=0;i<4;++i)n+=F[t&e],t>>>=4;return l(n)}function v(i){for(var t="",e=(b(i),b(i));e>-1;--e)t+=h(i.digits[e]);return t}function p(i){var t,e=48,n=e+9,r=97,s=r+25,o=65,g=90;return t=i>=e&&n>=i?i-e:i>=o&&g>=i?10+i-o:i>=r&&s>=i?10+i-r:0}function N(i){for(var t=0,e=Math.min(i.length,4),n=0;e>n;++n)t<<=4,t|=p(i.charCodeAt(n));return t}function y(i){for(var t=new d,e=i.length,n=e,r=0;n>0;n-=4,++r)t.digits[r]=N(i.substr(Math.max(n-4,0),Math.min(n,4)));return t}function m(i,t){var e;if(i.isNeg!=t.isNeg)t.isNeg=!t.isNeg,e=w(i,t),t.isNeg=!t.isNeg;else{e=new d;for(var n,r=0,s=0;s<i.digits.length;++s)n=i.digits[s]+t.digits[s]+r,e.digits[s]=65535&n,r=Number(n>=J);e.isNeg=i.isNeg}return e}function w(i,t){var e;if(i.isNeg!=t.isNeg)t.isNeg=!t.isNeg,e=m(i,t),t.isNeg=!t.isNeg;else{e=new d;var n,r;r=0;for(var s=0;s<i.digits.length;++s)n=i.digits[s]-t.digits[s]+r,e.digits[s]=65535&n,e.digits[s]<0&&(e.digits[s]+=J),r=0-Number(0>n);if(-1==r){r=0;for(var s=0;s<i.digits.length;++s)n=0-e.digits[s]+r,e.digits[s]=65535&n,e.digits[s]<0&&(e.digits[s]+=J),r=0-Number(0>n);e.isNeg=!i.isNeg}else e.isNeg=i.isNeg}return e}function b(i){for(var t=i.digits.length-1;t>0&&0==i.digits[t];)--t;return t}function k(i){var t,e=b(i),n=i.digits[e],r=(e+1)*I;for(t=r;t>r-I&&0==(32768&n);--t)n<<=1;return t}function M(i,t){for(var e,n,r,s=new d,o=b(i),g=b(t),a=0;g>=a;++a){for(e=0,r=a,j=0;j<=o;++j,++r)n=s.digits[r]+i.digits[j]*t.digits[a]+e,s.digits[r]=n&B,e=n>>>G;s.digits[a+o+1]=e}return s.isNeg=i.isNeg!=t.isNeg,s}function A(i,t){var e,n,r;result=new d,e=b(i),n=0;for(var s=0;e>=s;++s)r=result.digits[s]+i.digits[s]*t+n,result.digits[s]=r&B,n=r>>>G;return result.digits[1+e]=n,result}function C(i,t,e,n,r){for(var s=Math.min(t+r,i.length),o=t,g=n;s>o;++o,++g)e[g]=i[o]}function $(i,t){var e=Math.floor(t/I),n=new d;C(i.digits,0,n.digits,e,n.digits.length-e);for(var r=t%I,s=I-r,o=n.digits.length-1,g=o-1;o>0;--o,--g)n.digits[o]=n.digits[o]<<r&B|(n.digits[g]&H[r])>>>s;return n.digits[0]=n.digits[o]<<r&B,n.isNeg=i.isNeg,n}function x(i,t){var e=Math.floor(t/I),n=new d;C(i.digits,e,n.digits,0,i.digits.length-e);for(var r=t%I,s=I-r,o=0,g=o+1;o<n.digits.length-1;++o,++g)n.digits[o]=n.digits[o]>>>r|(n.digits[g]&X[r])<<s;return n.digits[n.digits.length-1]>>>=r,n.isNeg=i.isNeg,n}function U(i,t){var e=new d;return C(i.digits,0,e.digits,t,e.digits.length-t),e}function P(i,t){var e=new d;return C(i.digits,t,e.digits,0,e.digits.length-t),e}function z(i,t){var e=new d;return C(i.digits,0,e.digits,0,t),e}function K(i,t){if(i.isNeg!=t.isNeg)return 1-2*Number(i.isNeg);for(var e=i.digits.length-1;e>=0;--e)if(i.digits[e]!=t.digits[e])return i.isNeg?1-2*Number(i.digits[e]>t.digits[e]):1-2*Number(i.digits[e]<t.digits[e]);return 0}function S(i,t){var e,n,r=k(i),s=k(t),o=t.isNeg;if(s>r)return i.isNeg?(e=u(L),e.isNeg=!t.isNeg,i.isNeg=!1,t.isNeg=!1,n=w(t,i),i.isNeg=!0,t.isNeg=o):(e=new d,n=u(i)),new Array(e,n);e=new d,n=i;for(var g=Math.ceil(s/I)-1,a=0;t.digits[g]<O;)t=$(t,1),++a,++s,g=Math.ceil(s/I)-1;n=$(n,a),r+=a;for(var c=Math.ceil(r/I)-1,l=U(t,c-g);-1!=K(n,l);)++e.digits[c-g],n=w(n,l);for(var f=c;f>g;--f){var h=f>=n.digits.length?0:n.digits[f],v=f-1>=n.digits.length?0:n.digits[f-1],p=f-2>=n.digits.length?0:n.digits[f-2],N=g>=t.digits.length?0:t.digits[g],y=g-1>=t.digits.length?0:t.digits[g-1];h==N?e.digits[f-g-1]=B:e.digits[f-g-1]=Math.floor((h*J+v)/N);for(var M=e.digits[f-g-1]*(N*J+y),C=h*Q+(v*J+p);M>C;)--e.digits[f-g-1],M=e.digits[f-g-1]*(N*J|y),C=h*J*J+(v*J+p);l=U(t,f-g-1),n=w(n,A(l,e.digits[f-g-1])),n.isNeg&&(n=m(n,l),--e.digits[f-g-1])}return n=x(n,a),e.isNeg=i.isNeg!=o,i.isNeg&&(e=o?m(e,L):w(e,L),t=x(t,a),n=w(t,n)),0==n.digits[0]&&0==b(n)&&(n.isNeg=!1),new Array(e,n)}function V(i,t){return S(i,t)[0]}var W="http://"+rrloan.env.subdomain+"."+rrloan.env.domain,R=null;cryption.getKeys=function(i,n){var r=this;r.getKeys=function(){t.ajax({url:W+"/user/ajaxGetEncrpt",type:"post",dataType:"JSON",async:!1,success:function(i){1==i.isEncrypt?(a(2*i.maxdigits),R=new e(i.e,"null",i.n),"function"==typeof n&&n.call(this,R,i.rkey)):t.dialog.error("网络通信失败，请稍后再试！")}})},r.getKeys()},cryption.encrypt=function(i,t){encrypted=n(R,i),t(encrypted)};var T,q,E,L,G=16,I=G,J=65536,O=J>>>1,Q=J*J,B=J-1;a(20);var D=(c(1e15),new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z")),F=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"),H=new Array(0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535),X=new Array(0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535)}(jQuery),$(document).ready(function(){function i(){inputUserAccount.length&&(inputUserAccount.placeholder({defaultWord:"请输入您的手机号",defaultColor:"#ccc",activeColor:"#333"}),t()),inputPassWord.length&&(inputPassWord.placeholder({defaultWord:"请输入正确的密码",defaultColor:"#ccc",activeColor:"#333",style:{left:53,top:75,fontSize:"12px"},tipId:"psPlaceholder"}),t())}function t(){var i=inputUserAccount.val(),t=inputUserAccount.attr("placeholder");return i===t?"":i}function e(){t(),$.ajax({url:url+interfaceName.judgeValidate,type:"post",dataType:"json",data:"phone="+inputUserAccount.val(),success:function(i){i.count>=3&&a()}})}function n(){var i=$("#passWord"),t=inputUserAccount.val(),e=i.val();r(t,e,regionValidate)}function r(i,t,e){var n=null;if("block"===e.css("display")){var r=$("#validateCode").val();if(0!==i.length&&0!==t.length&&0!==r.length){var g=/^1\d{10}$/,a=g.test(i);a?s(i,t):(n="帐号请填写11位手机号",o(n))}else 0!==i.length&&0!==t.length&&0===r.length?(n="请输入验证码",o(n)):(n="请输入帐号和密码",o(n))}else if(0!==i.length&&0!==t.length){var g=/^1\d{10}$/,a=g.test(i);a?s(i,t):(n="帐号请填写11位手机号",o(n))}else n="请输入帐号和密码",o(n)}function s(i,t){var e,n,r,s;""!=rkey?cryption.encrypt(t,function(i){n=i}):n=t,e=i,r=chkRememberMe.val(),r=chkRememberMe.is(":checked")?1:2,s=$("#validateCode").val();var o="phone="+e+"&pwd="+n+"&savePass="+r+"&rkey="+rkey+"&icode="+s;$.ajax({url:url+interfaceName.login,type:"post",dataType:"json",data:o,async:!1,success:function(i){g(i)}})}function o(i){var t=$("#errorMessage");t.text(i),t.css("display","block")}function g(i){if(i.code===!0){var t=$("#redirectUrl").val();0!==t.length?window.location.href=t:window.location.href=url}i.code===!1&&(i.catchaCount>=3?(1===i.failCode&&(errMes="帐号或密码有误",o(errMes)),2===i.failCode&&(errMes="验证码有误",o(errMes)),a(),d()):(0===i.failCode&&(errMes="请输入正确的帐号",o(errMes)),1===i.failCode&&(errMes="帐号或密码有误",o(errMes)),2===i.failCode&&(errMes="验证码有误",o(errMes))))}function a(){var i=$("#ddValidateCode");i.css("display","block")}function d(){var i=$("#imgValidateCode");i.attr("src",url+"/icode?fontSize=36&"+Math.random())}getKeys();var u=rrloan.env.subdomain||"fenqi";domain=rrloan.env.domain||"renren.com",url="http://"+u+"."+domain,interfaceName={login:"/user/login",judgeValidate:"/user/webloginfailcount"},inputUserAccount=$("#userAccount"),inputPassWord=$("#passWord"),chkRememberMe=$("#rememberMe"),regionValidate=$("#ddValidateCode"),btnLogin=$("#login"),btnChangePic=$("#changePic"),inputUserAccount.blur(e),btnChangePic.bind({click:d}),btnLogin.bind({click:n}),document.onkeydown=function(i){var t=window.event||i,e=t.keyCode||t.which;13===e&&n()},i()});var rkey="";window.getKeys=function(){cryption.getKeys("key.jsp?generateKeypair=true",function(i,t){rkey=t})};